{"ast":null,"code":"import _toConsumableArray from \"C:/Users/Salman/Documents/BlockHacks/PSR/react-eth-metamask-signatures/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"C:/Users/Salman/Documents/BlockHacks/PSR/react-eth-metamask-signatures/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"C:/Users/Salman/Documents/BlockHacks/PSR/react-eth-metamask-signatures/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/Salman/Documents/BlockHacks/PSR/react-eth-metamask-signatures/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"C:\\\\Users\\\\Salman\\\\Documents\\\\BlockHacks\\\\PSR\\\\react-eth-metamask-signatures\\\\src\\\\SignMessage.js\",\n  _s = $RefreshSig$();\nimport { useState, useRef } from \"react\";\nimport { ethers } from \"ethers\";\nimport ErrorMessage from \"./ErrorMessage\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar signMessage = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n    var setError, message, provider, signer, signature, address;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setError = _ref.setError, message = _ref.message;\n            _context.prev = 1;\n            console.log({\n              message: message\n            });\n            if (window.ethereum) {\n              _context.next = 5;\n              break;\n            }\n            throw new Error(\"No crypto wallet found. Please install it.\");\n          case 5:\n            _context.next = 7;\n            return window.ethereum.send(\"eth_requestAccounts\");\n          case 7:\n            provider = new ethers.providers.Web3Provider(window.ethereum);\n            signer = provider.getSigner();\n            _context.next = 11;\n            return signer.signMessage(message);\n          case 11:\n            signature = _context.sent;\n            _context.next = 14;\n            return signer.getAddress();\n          case 14:\n            address = _context.sent;\n            return _context.abrupt(\"return\", {\n              message: message,\n              signature: signature,\n              address: address\n            });\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](1);\n            setError(_context.t0.message);\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 18]]);\n  }));\n  return function signMessage(_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport default function SignMessage() {\n  _s();\n  var _this = this;\n  var resultBox = useRef();\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    signatures = _useState2[0],\n    setSignatures = _useState2[1];\n  var _useState3 = useState(),\n    _useState4 = _slicedToArray(_useState3, 2),\n    error = _useState4[0],\n    setError = _useState4[1];\n  var handleSign = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e) {\n      var data, sig;\n      return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              e.preventDefault();\n              data = new FormData(e.target);\n              setError();\n              _context2.next = 5;\n              return signMessage({\n                setError: setError,\n                message: data.get(\"message\")\n              });\n            case 5:\n              sig = _context2.sent;\n              if (sig) {\n                setSignatures([].concat(_toConsumableArray(signatures), [sig]));\n              }\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return function handleSign(_x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"m-4\",\n    onSubmit: handleSign,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"credit-card w-full shadow-lg mx-auto rounded-xl bg-white\",\n      children: [/*#__PURE__*/_jsxDEV(\"main\", {\n        className: \"mt-4 p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-semibold text-gray-700 text-center\",\n          children: \"Sign messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"my-3\",\n            children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n              required: true,\n              type: \"text\",\n              name: \"message\",\n              className: \"textarea w-full h-24 textarea-bordered focus:ring focus:outline-none\",\n              placeholder: \"Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 54,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 53,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        className: \"p-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-primary submit-button focus:ring focus:outline-none w-full\",\n          children: \"Sign message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n          message: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), signatures.map(function (sig, idx) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-2\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"my-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Message \", idx + 1, \": \", sig.message]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Signer: \", sig.address]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              type: \"text\",\n              readOnly: true,\n              ref: resultBox,\n              className: \"textarea w-full h-24 textarea-bordered focus:ring focus:outline-none\",\n              placeholder: \"Generated signature\",\n              value: sig.signature\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 15\n          }, _this)\n        }, sig, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 13\n        }, _this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 46,\n    columnNumber: 5\n  }, this);\n}\n_s(SignMessage, \"wYqypxPM1oC2N8a1QMses1Q8zEU=\");\n_c = SignMessage;\nvar _c;\n$RefreshReg$(_c, \"SignMessage\");","map":{"version":3,"names":["useState","useRef","ethers","ErrorMessage","signMessage","setError","message","console","log","window","ethereum","Error","send","provider","providers","Web3Provider","signer","getSigner","signature","getAddress","address","SignMessage","resultBox","signatures","setSignatures","error","handleSign","e","preventDefault","data","FormData","target","get","sig","map","idx"],"sources":["C:/Users/Salman/Documents/BlockHacks/PSR/react-eth-metamask-signatures/src/SignMessage.js"],"sourcesContent":["import { useState, useRef } from \"react\";\nimport { ethers } from \"ethers\";\nimport ErrorMessage from \"./ErrorMessage\";\n\nconst signMessage = async ({ setError, message }) => {\n  try {\n    console.log({ message });\n    if (!window.ethereum)\n      throw new Error(\"No crypto wallet found. Please install it.\");\n\n    await window.ethereum.send(\"eth_requestAccounts\");\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n    const signer = provider.getSigner();\n    const signature = await signer.signMessage(message);\n    const address = await signer.getAddress();\n\n    return {\n      message,\n      signature,\n      address\n    };\n  } catch (err) {\n    setError(err.message);\n  }\n};\n\nexport default function SignMessage() {\n  const resultBox = useRef();\n  const [signatures, setSignatures] = useState([]);\n  const [error, setError] = useState();\n\n  const handleSign = async (e) => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n    setError();\n    const sig = await signMessage({\n      setError,\n      message: data.get(\"message\")\n    });\n    if (sig) {\n      setSignatures([...signatures, sig]);\n    }\n  };\n\n  return (\n    <form className=\"m-4\" onSubmit={handleSign}>\n      <div className=\"credit-card w-full shadow-lg mx-auto rounded-xl bg-white\">\n        <main className=\"mt-4 p-4\">\n          <h1 className=\"text-xl font-semibold text-gray-700 text-center\">\n            Sign messages\n          </h1>\n          <div className=\"\">\n            <div className=\"my-3\">\n              <textarea\n                required\n                type=\"text\"\n                name=\"message\"\n                className=\"textarea w-full h-24 textarea-bordered focus:ring focus:outline-none\"\n                placeholder=\"Message\"\n              />\n            </div>\n          </div>\n        </main>\n        <footer className=\"p-4\">\n          <button\n            type=\"submit\"\n            className=\"btn btn-primary submit-button focus:ring focus:outline-none w-full\"\n          >\n            Sign message\n          </button>\n          <ErrorMessage message={error} />\n        </footer>\n        {signatures.map((sig, idx) => {\n          return (\n            <div className=\"p-2\" key={sig}>\n              <div className=\"my-3\">\n                <p>\n                  Message {idx + 1}: {sig.message}\n                </p>\n                <p>Signer: {sig.address}</p>\n                <textarea\n                  type=\"text\"\n                  readOnly\n                  ref={resultBox}\n                  className=\"textarea w-full h-24 textarea-bordered focus:ring focus:outline-none\"\n                  placeholder=\"Generated signature\"\n                  value={sig.signature}\n                />\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </form>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}